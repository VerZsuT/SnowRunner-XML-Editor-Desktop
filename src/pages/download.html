<!DOCTYPE html>
<html>
    <head>
        <title>Processing</title>
    </head>
    <body>
        <div id="file-name"></div>
        <progress id="progress" value="0" max="100"></progress>
        <small id="count"></small>

        <style>
            body {
                display: flex;
                justify-content: center;
                align-items: center;
                height: 30px;
            }
            #count {
                display: none;
            }
            #file-name {
                display: none;
                width: 100%;
                text-align: center;
                font-weight: bold;
                font-size: 10px;
                position: absolute;
                top: 2px;
            }
        </style>

        <script>
            const $progress = document.querySelector('#progress')
            const $count = document.querySelector('#count')
            const $fileName = document.querySelector('#file-name')

            let count = null

            ipcRenderer.once('count', (_e, msg) => {
                count = msg

                $count.innerText = `0/${count}`
                $count.style.display = 'inline'
            })


            ipcRenderer.once('download', () => {
                clearInterval(interval)
            })

            ipcRenderer.on('success', () => {
                $count.innerText = `${+$count.innerText.split('/')[0] + 1}/${count}`
                $progress.value = 0
            })

            ipcRenderer.on('fileName', (_e, msg) => {
                $fileName.innerText = msg
                $fileName.style.display = 'block'
            })

            ipcRenderer.on('percent', (_event, message) => {
                $progress.value = message
            })

            let interval = setInterval(() => {
                const value = +$progress.value
                if (value >= 50) {
                    $progress.value = 0
                }
                else {
                    $progress.value += 1
                }
            }, 100)
        </script>
    </body>
</html>